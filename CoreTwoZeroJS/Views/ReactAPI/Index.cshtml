
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<br /><br />

<!--Here goes the greeting-->
<div id="root"></div>

<!--Here goes the API data-->
<div id="rootapi"></div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>


<script type="text/babel">

    class Greeting extends React.Component {
    render() {
    return (
    <p>Consuming a Web Api by ReactJS and using "fetch()" </p>);
    }

    componentDidMount(){

    }
    }


    ReactDOM.render(
    <Greeting />,
    document.getElementById('root')
    );


</script>


<script type="text/babel" data-presets="es2015, react, stage-2">

    class GetPersons extends React.Component {

    constructor(props) {

    super(props)

    this.state = {
    persons: []

    };

    }

    componentDidMount(){

    // Dear team, this is not working when testing locally, and I dont thinkt IE are fully sorting this fetch !!!
    fetch('http://persons.api.core.persteenolsen.com/api/PersonTableCoreTwoJSApi/')
    .then(response => response.json())
    .then(data => { this.setState({ persons: data }) })

    //.catch(error => console.log('error fetching', error))

    // Dear team, use this testing locally and json-data represents the data (at the moment) you should get by fech
    //this.setState( { persons: [{"id":1,"firstName":"Hans","lastName":"Hansen","phone":"22334455","email":"aaaa@bbb.dk","age":"48","editable":"No","profession":"Sales Man"},{"id":2,"firstName":"Per","lastName":"Olsen","phone":"33445566","email":"per@olsen.dk","age":"50","editable":"No","profession":"Web Developer"},{"id":4,"firstName":"Ib","lastName":"Ibsen","phone":"11887766","email":"ib@ibsen","age":"33","editable":"Yes","profession":"Fischerman"},{"id":8,"firstName":"Ole","lastName":"Olsen","phone":null,"email":null,"age":"46","editable":"Yes","profession":"Pilot"},{"id":10,"firstName":"Lars","lastName":"Petersen","phone":null,"email":null,"age":"33","editable":"Yes","profession":"Teacher"}] });


    }


    render(){

    return (
    <div>
        <div>Id Name LastName Age Profession</div>
        {this.state.persons.map(person =>
        <div key={person.id}> {person.id} {person.firstName} {person.lastName} {person.age} {person.profession} </div>)}
    </div>
    );
    }


    }


    ReactDOM.render(
    <GetPersons />,
    document.getElementById('rootapi')
    );

</script>
